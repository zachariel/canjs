<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE -- ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: docs/can-guides/commitment/recipes/canvas-clock/canvas-clock.md
	@page guides/recipes/canvas-clock
######################################################################## -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CanJS - Canvas Clock (Simple)</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	
		<link rel="stylesheet" type="text/css" href="../../static/bundles/bit-docs-site/static.css">
		<link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64" href="/docs/images/canjs_favicon.ico">
		<link rel="apple-touch-icon" sizes="57x57" href="../../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../docs/images/canjs_favicon_57x57.png">
		<link rel="apple-touch-icon" sizes="72x72" href="../../../docs/images/canjs_favicon_72x72.png">
		<link rel="apple-touch-icon" sizes="114x114" href="../../../docs/images/canjs_favicon_114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="../../../docs/images/canjs_favicon_128x128.png">
		<link rel="apple-touch-icon" sizes="144x144" href="../../../docs/images/canjs_favicon_144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="../../../docs/images/canjs_favicon_152x152.png">
		<meta content="yes" name="apple-mobile-web-app-capable">
	  	<meta name="apple-mobile-web-app-status-bar-style" content="white-translucent">
	
	
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-2302003-11', 'auto');
			ga('send', 'pageview');
		</script>
	
</head>
	<body>
		<input type="checkbox" id="nav-trigger" class="nav-trigger"/>
		<label for="nav-trigger">Menu</label>
	  	<div id="everything">
  <div id="left" class="column">
    <div class="top-left">
      
          <div class="brand">
	<div class="logo">
		<a href="../../../index.html" alt="CanJS"></a>
		<div class="dropdown project-dropdown">
			<a href="https://donejs.com/">DoneJS</a>
			<a href="https://stealjs.com/">StealJS</a>
			<a href="https://jquerypp.com/">jQuery++</a>
			<a href="https://funcunit.com/">FuncUnit</a>
			<a href="https://documentjs.com/">DocumentJS</a>
		</div>
	</div>
	<div class="version">
		<div class="version-number">
			4.0.1
		</div>
		<div class="dropdown version-dropdown">
			
				<a href="https://v3.canjs.com">3.12.1</a>
			
				<a href="https://v2.canjs.com">2.3.33</a>
			
		</div>
	</div>
</div>
<div class="search-bar">
	<div class="search-wrap" style="display:none;">
		<span class="search-icon"></span>
		<input
			type="text"
			size="6"
			class="search"
			placeholder="Search"
			autocomplete="off"
			autocorrect="off"
			autocapitalize="none"
			spellcheck="false"/>
			<span class="search-icon-cancel"></span>
	</div>
</div>


      
    </div>
    <div class="bottom">
      <div class="nav-menu">
        <div class="social-side-container">
          <ul class="social-side">
  <li>
    <a class="header-mobile github" href="https://github.com/canjs/canjs" target="_blank"><img class="social-icon-small" src="../../../docs/images/github.png">Github</a>
  </li>
  <li>
    <a class="header-mobile twitter" href="https://twitter.com/canjs" target="_blank"><img class="social-icon-small" src="../../../docs/images/twitter.png">Twitter</a>
  </li>
</ul>
<ul class="social-side">
  <li>
    <a class="header-mobile" href="https://gitter.im/canjs/canjs" target="_blank">Chat</a>
  </li>
  <li>
    <a class="header-mobile" href="http://forums.donejs.com/c/canjs" target="_blank">Forum</a>
  </li>
</ul>

        </div>
        
            
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../about.html"
							title="Learn about CanJS’s mission, technical highlights, who uses CanJS, and our future roadmap.">
							About
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../../guides.html"
							title="Welcome to CanJS! These guides are here to help you develop and improve your relationship with CanJS. After all, picking a JavaScript framework is a commitment.  We want CanJS to be the framework you marry.  This page helps you know how to advance through the different stages of this relationship:">
							Guides
						</a>
						
	<ul>
		
			
				
					<li>
						<span>experiment</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../chat.html"
							title="This guide will walk you through building a real-time chat application with CanJS’s Core libraries.  It takes about 30 minutes to complete.">
							Chat Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../todomvc.html"
							title="This guide will walk you through building a slightly modified version of TodoMVC with CanJS’s Core libraries and can-fixture. It takes about 1 hour to complete.">
							TodoMVC Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../atm.html"
							title="This guide will walk you through building and testing an Automated Teller Machine (ATM) application with CanJS’s
Core libraries.  You’ll learn how to do test driven development (TDD)
and manage complex state.  It takes about 2 hours to complete.">
							ATM Guide
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li class="
           						parent
           						expanded">
						<a class="page"
							href="../recipes.html"
							title="A listing of small examples that are useful for learning CanJS.">
							recipes
						</a>
						
	<ul>
		
			
				
					<li class="current
           						
           						expanded">
						<a class="page"
							href="canvas-clock.html"
							title="This guide walks you through building a canvas clock.">
							Canvas Clock (Simple)
						</a>
						

					</li>
				
			
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="credit-card-simple.html"
							title="This guide walks through building a very simple credit card payment form.  It uses Stripe.js v2 API to create a token
which can be used to create a charge.  It also performs
simple validation on the payment form values.">
							Credit Card Guide (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="cta-bus-map.html"
							title="This guide walks you through showing Chicago Transit Authority (CTA) bus locations on a Google Map.">
							CTA Bus Map (Medium)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="file-navigator-advanced.html"
							title="This guide walks you through building a file navigation widget.  It takes about 45 minutes to complete.  It was written with
CanJS 3.10. Check out the file-navigator-simple
for an easier example that produces similar functionality.">
							File Navigator Guide (Advanced)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="file-navigator-simple.html"
							title="This guide walks you through building a simple file navigation widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.10. Check out the file-navigator-advanced
for an example that makes AJAX requests for its data and uses can-component.">
							File Navigator Guide (Simple)
						</a>
						

					</li>
				
			
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="signup-simple.html"
							title="This guide walks through building simple signup, login forms and a logout button.">
							Signup and Login (Simple)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="text-editor.html"
							title="This guide walks you through building a basic rich text editor.">
							Text Editor (Medium)
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="todomvc-with-steal.html"
							title="This guide walks through building TodoMVC with StealJS.">
							TodoMVC with StealJS
						</a>
						

					</li>
				
			
		
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="weather-report-simple.html"
							title="This guide walks you through building a simple weather report widget.  It takes about 25 minutes to complete.  It was written with
CanJS 3.5.">
							Weather Report Guide (Simple)
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>getting started</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../setup.html"
							title="Get started with CanJS by installing it with npm, using a JS&amp;nbsp;Bin, or just adding it to an HTML page with a &lt;script&gt; tag.">
							Setting up CanJS
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../technology-overview.html"
							title="Learn the basics of the core parts of CanJS&#x27;s technology.">
							Technology Overview
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../api.html"
							title="This page walks through how to use and understand CanJS’s API documentation.">
							Reading the Docs (API Guide)
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>topics</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../debugging.html"
							title="Learn how to debug CanJS applications.">
							Debugging Guide
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../forms.html"
							title="Learn how to create amazing &lt;form&gt;s with CanJS. This guide gives an overview of binding to form element attributes and events, then describes the ins and outs of common elements, and finally discusses a few more advanced topics. We recommend reading the Bindings overview section first before jumping to the topic that interests you &amp;mdash; or start at the top to become an expert on it all.">
							Forms Guide
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li>
						<span>upgrade</span>
						
	<ul>
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../migrate-3.html"
							title="This guide walks you through the step-by-step process to upgrade a 2.x app to CanJS 3.">
							Migrating to CanJS 3
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../migrate-4.html"
							title="This guide walks you through the step-by-step process to upgrade a 3.x app to CanJS 4.">
							Migrating to CanJS 4
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../upgrade/using-codemods.html"
							title="Learn how to migrate your app to CanJS 3 using can-migrate.">
							Using Codemods
						</a>
						

					</li>
				
			
		
	</ul>


					</li>
				
			
		
	</ul>


					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../api.html"
							title="Welcome to the CanJS API documentation! Learn about all the packages that make-up CanJS and how they work together to help you build amazing applications.">
							API Docs
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../../community.html"
							title="Get involved with one of the most inviting communities on the internet!">
							Community
						</a>
						

					</li>
				
			
		
			
				
					<li class="
           						
           						">
						<a class="page"
							href="../contribute.html"
							title="Learn how to contribute to CanJS!">
							Contributing
						</a>
						

					</li>
				
			
		
	</ul>


        
      </div>
      <div class="search-results-container">
	<div class="search-results-wrap"></div>
</div>

    </div>
  </div>
  <div id="right" class="column">
    <div class="top-right">
      <div class="top-right-top">
	<ul class="top-right-bitovi">
	  	<li class="dropdown">
	    	<a href="https://www.bitovi.com" class="bitovi icon-bits">Bitovi</a>
	    	<ul class="dropdown-menu">
	      		<li><a href="https://www.bitovi.com/">Bitovi.com</a></li>
	      		<li><a href="https://www.bitovi.com/blog">Blog</a></li>
	      		<li><a href="https://www.bitovi.com/design">Design</a></li>
	      		<li><a href="https://www.bitovi.com/development">Development</a></li>
	      		<li><a href="https://www.bitovi.com/training">Training</a></li>
	      		<li><a href="https://www.bitovi.com/open-source">Open Source</a></li>
	      		<li><a href="https://www.bitovi.com/about">About</a></li>
	      		<li><a href="https://www.bitovi.com/contact">Contact Us</a></li>
	    	</ul>
	  	</li>
	</ul>
	<div class="brand">
		<div class="logo">
			<a href="../../../index.html" alt="CanJS"></a>
		</div>
	</div>
	<ul class="top-right-links">
  <li>
    <a href="https://gitter.im/canjs/canjs">Chat</a>
  </li>
  <li>
    <a href="http://forums.donejs.com/c/canjs">Forum</a>
  </li>
  <li>
    <a class="github-button nav-social" href="https://github.com/canjs/canjs" data-count-href="/canjs/canjs/stargazers" data-show-count="true">Star</a>
  </li>
  <li>
    <a href="https://twitter.com/canjs" class="twitter-follow-button nav-social" data-show-count="true" data-show-screen-name="false">Follow @canjs</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </li>
</ul>
</div>
<div class="breadcrumb">
	
		<li><a href="../../../index.html">CanJS</a></li>
		<li> / </li>
	
		<li><a href="../../guides.html">Guides</a></li>
		<li> / </li>
	
		<li><a href="../recipes.html">recipes</a></li>
		<li> / </li>
	
	
	<li><a href="canvas-clock.html">Canvas Clock (Simple)</a></li>
	
	<li class="breadcrumb-dropdown-separator"> / </li>
	<li class="breadcrumb-dropdown">
		<a> On this page</a>
		<ul class="on-this-page"></ul>
	</li>
	<div class="nav-toggle" title="Back to top"></div>
</div>


    </div>
    <div class="bottom">
      <article>
  <section class="title">
	<div class="page-type">
		<h1>Canvas Clock (Simple)</h1>
			<ul class="title-social">
				
				
				<li>
					<a class="button-link" href="//github.com/canjs/canjs/edit/master/docs/can-guides/commitment/recipes/canvas-clock/canvas-clock.md">Edit on GitHub</a>
				</li>
				
			</ul>
	</div>
	<div class="clear-both"></div>
	
  
	<section class="description">
    <p>This guide walks you through building a canvas clock.</p>

</section>

  
	
</section>
<section class="on-this-page-table">
</section>











  
    <section class="body">
    <p>In this guide you will learn how to:</p>
<ul>
<li>Create custom elements for digital and analog clocks</li>
<li>Use the <code>canvas</code> API to draw the hands of the analog clock</li>
</ul>
<p>The final widget looks like:</p>
<p><a class="jsbin-embed" href="https://jsbin.com/zefajic/14/embed?output&height=400px">JS Bin on jsbin.com</a></p>
<p>The following sections are broken down the following parts:</p>
<ul>
<li><strong>The problem</strong> — A description of what the section is trying to accomplish.</li>
<li><strong>What you need to know</strong> — Information about CanJS that is useful for solving the problem.</li>
<li><strong>How to verify it works</strong> - How to make sure the solution works if it's not obvious.</li>
<li><strong>The solution</strong> — The solution to the problem.</li>
</ul>
<h2>Setup</h2>
<p><strong>START THIS TUTORIAL BY CLONING THE FOLLOWING JS Bin</strong>:</p>
<blockquote>
<p>Click the <code>JS Bin</code> button.  The JSBin will open in a new window. In that new window, under <code>File</code>, click <code>Clone</code>.</p>
</blockquote>
<p><a class="jsbin-embed" href="https://jsbin.com/zomefef/7/embed?html,js,output">CanJS Bus Demo on jsbin.com</a></p>
<p>This JS Bin has initial prototype HTML, CSS, and JS to bootstrap a basic CanJS application.</p>
<h3>What you need to know</h3>
<p>There's nothing to do in this step. The JSBin is already setup with:</p>
<ul>
<li>A <em>basic</em> CanJS setup.</li>
<li>A <code>&lt;clock-controls&gt;</code> custom element that:
<ul>
<li>updates a <code>time</code> property every second</li>
<li>passes the <code>time</code> value to a <code>&lt;digital-clock&gt;</code> and
<code>&lt;analog-clock&gt;</code> component that will be defined in future sections.</li>
</ul></li>
</ul>
<p>Please read on to understand the setup.</p>
<p><strong>A Basic CanJS Setup</strong></p>
<p>A basic CanJS setup is usually a custom element.  In the <code>HTML</code>
tab, you'll find a <code>&lt;clock-controls/&gt;</code> element.  The following code in the <code>JS</code> tab
defines the behavior of the <code>&lt;clock-controls/&gt;</code> element:</p>
<pre><code class="language-js">const ClockControlsVM = can.DefineMap.extend(&quot;ClockControlsVM&quot;,{
  time: {
    value({ resolve }) {
      const intervalID = setInterval(() =&gt; {
        resolve( new Date() );
      },1000);

      resolve( new Date() );

      return () =&gt; clearInterval(intervalID);
    }
  }
});

can.Component.extend({
  tag: &quot;clock-controls&quot;,
  ViewModel: ClockControlsVM,
  view: can.stache(`
    &lt;p&gt;{{time}}&lt;/p&gt;
    &lt;digital-clock time:from=&quot;time&quot;/&gt;
    &lt;analog-clock time:from=&quot;time&quot;/&gt;
  `)
});
</code></pre>
<p>You'll notice the behavior is defined in two parts.  First is the <code>ClockControlsVM</code> type.  This
is an observable constructor function created with <a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a>.  Here, a <code>time</code>
property is defined using the <a href="../../can-define.types.value.html" title="Specify the behavior of a property by listening to changes in other properties.">value behavior</a>. This uses <code>resolve</code> to set
the value of <code>time</code> to be an instance of a <code>Date</code> and then update the value every second to be a
new <code>Date</code>.</p>
<p>One could create an instance of <code>ClockControlsVM</code> and explore it's <code>time</code> property as follows:</p>
<pre><code class="language-js">const vm = new ClockControlsVM();
vm.time //-&gt; Wed Nov 01 2017 14:31:25 GMT-0500 (CDT)
</code></pre>
<p>The next part uses <a href="../../can-component.html" title="Create a custom element that can be used to manage widgets or application logic.">can-component</a> to define the behavior of the  <code>&lt;clock-controls&gt;</code>
element. <a href="../../can-component.html" title="Create a custom element that can be used to manage widgets or application logic.">can-component</a> has configured properties that define the behavior of the element.</p>
<ul>
<li><code>tag</code> is used to specify the name of the custom element. (ex: <code>&quot;clock-controls&quot;</code>)</li>
<li><code>view</code> is used as the HTML content within the custom element.  It is usually a <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a>
template.</li>
<li><code>ViewModel</code> provides methods and values to the <code>view</code>.  <code>ViewModel</code>s are usually a typeof
<a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a>.</li>
</ul>
<h2>Create a digital clock component</h2>
<h3>The problem</h3>
<p>In this section, we will:</p>
<ul>
<li>Create a <code>&lt;digital-clock&gt;</code> custom element.</li>
<li>Pass the <code>time</code> from the <code>&lt;clock-controls&gt;</code> element to the <code>&lt;digital-clock&gt;</code> element.</li>
<li>Write out the time in the format: <code>hh:mm:ss</code>.</li>
</ul>
<h3>What you need to know</h3>
<ul>
<li>Use <a href="../../can-component.html" title="Create a custom element that can be used to manage widgets or application logic.">can-component</a> to create a custom element.
<ul>
<li><code>tag</code> is used to specify the name of the custom element. (hint: <code>&quot;digital-clock&quot;</code>)</li>
<li><code>view</code> is used as the HTML content within the custom element.  It is usually a <a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a>
template.  (hint: <code>can.stache(&quot;Your {{content}}&quot;)</code>).</li>
<li><code>ViewModel</code> provides methods and values to the <code>view</code>.  <code>ViewModel</code>s are usually a typeof
<a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a>.</li>
</ul></li>
<li><a href="../../can-stache.html" title="Live binding Mustache and Handlebars-compatible templates.">can-stache</a> can insert the return value from function calls into the page like:
<pre><code>{{method()}}
</code></pre>
These methods are often functions on the <code>ViewModel</code>.</li>
<li>Use <a href="../../can-define/map/map.html" title="Create observable objects.">can-define/map/map</a> to define properties and methods like:
<pre><code class="language-js">var DigitalClockVM = can.DefineMap.extend({
  property: Type, //hint -&gt; time: Date
  method() {
      return ...;
  }
})
</code></pre></li>
<li>The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date">Date</a> has
methods that give you details about that date and time:
<ul>
<li><code>date.getSeconds()</code></li>
<li><code>date.getMinutes()</code></li>
<li><code>date.getHours()</code></li>
</ul></li>
<li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padStart">padStart</a>
to convert a string like <code>&quot;1&quot;</code> into <code>&quot;01&quot;</code> like <code>.padStart(2,&quot;00&quot;)</code>.</li>
</ul>
<h3>The solution</h3>
<p>Update the <strong>JavaScript</strong> tab to:</p>
<pre><code class="language-js">const DigitalClockVM = can.DefineMap.extend(&quot;DigitalClockVM&quot;,{
  time: Date,
  hh(){
    const hr = this.time.getHours() % 12;
    return hr === 0 ? 12 : hr;
  },
  mm(){
    return this.time.getMinutes().toString().padStart(2,&quot;00&quot;);
  },
  ss(){
    return this.time.getSeconds().toString().padStart(2,&quot;00&quot;);
  }
});

can.Component.extend({
  tag: &quot;digital-clock&quot;,
  view: can.stache(`{{hh()}}:{{mm()}}:{{ss()}}`),
  ViewModel: DigitalClockVM
});

const ClockControlsVM = can.DefineMap.extend(&quot;ClockControlsVM&quot;,{
  time: {
    value({ resolve }) {
      const intervalID = setInterval(() =&gt; {
        resolve( new Date() );
      },1000);

      resolve( new Date() );

      return () =&gt; clearInterval(intervalID);
    }
  }
});

can.Component.extend({
  tag: &quot;clock-controls&quot;,
  ViewModel: ClockControlsVM,
  view: can.stache(`
    &lt;p&gt;{{time}}&lt;/p&gt;
    &lt;digital-clock time:from=&quot;time&quot;/&gt;
    &lt;analog-clock time:from=&quot;time&quot;/&gt;
  `)
});

</code></pre>
<p><span line-highlight='1-19,only'></span></p>
<h2>Draw a circle in the analog clock component</h2>
<h3>The problem</h3>
<p>In this section, we will:</p>
<ul>
<li>Create a <code>&lt;analog-clock&gt;</code> custom element.</li>
<li>Draw a circle inside the <code>&lt;canvas/&gt;</code> element within the <code>&lt;analog-clock&gt;</code>.</li>
</ul>
<h3>What you need to know</h3>
<ul>
<li>Use another <a href="../../can-component.html" title="Create a custom element that can be used to manage widgets or application logic.">can-component</a> to define a <code>&lt;analog-clock&gt;</code> component.</li>
<li>Define the component's <code>view</code> to write out a <code>&lt;canvas&gt;</code> element. (hint: <code>&lt;canvas id=&quot;analog&quot; width=&quot;255&quot; height=&quot;255&quot;&gt;&lt;/canvas&gt;</code>).</li>
<li>A component's viewModel can be defined as an object which will be passed to <a href="../../can-define/map/map.extend.html" title="Define a custom map type.">DefineMap.extend</a>. (hint:<code>ViewModel: {}</code>)</li>
<li>A viewModel's <a href="../../can-component/connectedCallback.html" title="A lifecycle hook called after the component's element is inserted into the document.">connectedCallback</a> will be called when the component is inserted into the page and will be passed the <code>element</code> like:
<pre><code class="language-js">can.Component.extend({
  tag: &quot;my-element&quot;,
  view: can.stache(`&lt;h1&gt;first child&lt;/h1&gt;`),
  ViewModel: {
    connectedCallback(element) {
      element.firstChild //-&gt; &lt;h1&gt;
    }
  }
});
</code></pre></li>
<li>To get the <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D">canvas rendering context</a>
from a <code>&lt;canvas&gt;</code> element use <code>canvas = canvasElement.getContext('2d')</code>.</li>
<li>To draw a line (or curve), you generally set different style properties of the rendering context like:
<pre><code class="language-js">canvas.lineWidth = 4.0
canvas.strokeStyle = &quot;#567&quot;
</code></pre>
Then you start path with:
<pre><code class="language-js">canvas.beginPath()
</code></pre>
Then make <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D">arcs</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineTo">lines</a>
for your path like:
<pre><code class="language-js">canvas.arc(125,125,125,0,Math.PI * 2,true)
</code></pre>
Then close the path like:
<pre><code class="language-js">canvas.closePath()
</code></pre>
Finally, use <code>stroke</code> to actually draw the line:
<pre><code class="language-js">canvas.stroke();
</code></pre></li>
<li>The following variables will be useful for coordinates:
<pre><code class="language-js">this.diameter = 255;
this.radius = this.diameter/2 - 5;
this.center = this.diameter/2;
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the <strong>JavaScript</strong> tab to:</p>
<pre><code class="language-js">can.Component.extend({
  tag: &quot;analog-clock&quot;,
  view: can.stache(`&lt;canvas id=&quot;analog&quot;  width=&quot;255&quot; height=&quot;255&quot;&gt;&lt;/canvas&gt;`),
  ViewModel: {
    connectedCallback(element) {
      const canvas = element.firstChild.getContext('2d');
      const diameter = 255;
      const radius = diameter/2 - 5;
      const center = diameter/2;
      // draw circle
      canvas.lineWidth = 4.0;
      canvas.strokeStyle = &quot;#567&quot;;
      canvas.beginPath();
      canvas.arc(center, center, radius, 0, Math.PI * 2, true);
      canvas.closePath();
      canvas.stroke();
    }
  }
});

const DigitalClockVM = can.DefineMap.extend(&quot;DigitalClockVM&quot;,{
  time: Date,
  hh(){
    const hr = this.time.getHours() % 12;
    return hr === 0 ? 12 : hr;
  },
  mm(){
    return this.time.getMinutes().toString().padStart(2,&quot;00&quot;);
  },
  ss(){
    return this.time.getSeconds().toString().padStart(2,&quot;00&quot;);
  }
});

can.Component.extend({
  tag: &quot;digital-clock&quot;,
  view: can.stache(`{{hh()}}:{{mm()}}:{{ss()}}`),
  ViewModel: DigitalClockVM
});

const ClockControlsVM = can.DefineMap.extend(&quot;ClockControlsVM&quot;,{
  time: {
    value({ resolve }) {
      const intervalID = setInterval(() =&gt; {
        resolve( new Date() );
      },1000);

      resolve( new Date() );

      return () =&gt; clearInterval(intervalID);
    }
  }
});

can.Component.extend({
  tag: &quot;clock-controls&quot;,
  ViewModel: ClockControlsVM,
  view: can.stache(`
    &lt;p&gt;{{time}}&lt;/p&gt;
    &lt;digital-clock time:from=&quot;time&quot;/&gt;
    &lt;analog-clock time:from=&quot;time&quot;/&gt;
  `)
});

</code></pre>
<p><span line-highlight='1-19,only'></span></p>
<h2>Draw the second hand</h2>
<h3>The problem</h3>
<p>In this section, we will:</p>
<ul>
<li>Draw the second hand needle when the <code>time</code> value changes
on the <code>viewModel</code>.</li>
<li>The needle should be <code>2</code> pixels wide, red (<code>#FF0000</code>), and 85% of the
clock's radius.</li>
</ul>
<h3>What you need to know</h3>
<ul>
<li><p><a href="../../can-event-queue/map/map.listenTo.html" title="Listen to an event and register the binding for simplified unbinding.">this.listenTo</a> can be used in a component's <code>connectedCallback</code> to listen to changes in the <code>ViewModel</code> like:</p>
<pre><code class="language-js">can.Component.extend({
  tag: &quot;analog-clock&quot;,
  ...
  ViewModel: {
    connectedCallback() {
      this.listenTo(&quot;time&quot;, (ev, time) =&gt; {
        ...
      });
    }
  }
});
</code></pre></li>
<li><p>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext/moveTo">canvas.moveTo(x1,y1)</a>
and <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineTo">canvas.lineTo(x2,y2)</a>
to draw a line from one position to another.</p></li>
<li><p>To get the needle point to move around a &quot;unit&quot; circle, you'd want to make the following calls given the number of seconds:</p>
<pre><code>0s  -&gt; .lineTo(.5,0)
15s -&gt; .lineTo(1,.5)
30s -&gt; .lineTo(.5,1)
45s -&gt; .lineTo(0,.5)
</code></pre></li>
<li><p>Our friends <code>Math.sin</code> and <code>Math.cos</code> can help here.  But they take radians.</p>
<p><img src="https://www.mathsisfun.com/algebra/images/sine-cosine-graph.gif" alt="Sine and Cosine Graph" /></p>
<p>Use the following <code>base60ToRadians</code> method to convert a number from 0-60 to one between 0 and 2π:</p>
<pre><code class="language-js">// 60 = 2π
const base60ToRadians = (base60Number) =&gt;
  2 * Math.PI * base60Number / 60;
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the <strong>JavaScript</strong> tab to:</p>
<pre><code class="language-js">// 60 = 2π
const base60ToRadians = (base60Number) =&gt;
2 * Math.PI * base60Number / 60;

can.Component.extend({
  tag: &quot;analog-clock&quot;,
  view: can.stache(`&lt;canvas id=&quot;analog&quot;  width=&quot;255&quot; height=&quot;255&quot;&gt;&lt;/canvas&gt;`),
  ViewModel: {
    connectedCallback(element) {
      const canvas = element.firstChild.getContext('2d');
      const diameter = 255;
      const radius = diameter/2 - 5;
      const center = diameter/2;
      // draw circle
      canvas.lineWidth = 4.0;
      canvas.strokeStyle = &quot;#567&quot;;
      canvas.beginPath();
      canvas.arc(center, center, radius, 0, Math.PI * 2, true);
      canvas.closePath();
      canvas.stroke();

      this.listenTo(&quot;time&quot;, (ev, time) =&gt; {
        canvas.clearRect(0, 0, diameter, diameter);

        // draw circle
        canvas.lineWidth = 4.0;
        canvas.strokeStyle = &quot;#567&quot;;
        canvas.beginPath();
        canvas.arc(center, center, radius, 0, Math.PI * 2, true);
        canvas.closePath();
        canvas.stroke();

        Object.assign(canvas, {
          lineWidth:  2.0,
          strokeStyle: &quot;#FF0000&quot;,
          lineCap: &quot;round&quot;
        });
        // draw second hand
        const seconds = time.getSeconds() + this.time.getMilliseconds() / 1000;
        const size = radius * 0.85,
          x = center + size * Math.sin(base60ToRadians(seconds)),
          y = center + size * -1 * Math.cos(base60ToRadians(seconds));
        canvas.beginPath();
        canvas.moveTo(center, center);
        canvas.lineTo(x, y);
        canvas.closePath();
        canvas.stroke();
      });
    }
  }
});

const DigitalClockVM = can.DefineMap.extend(&quot;DigitalClockVM&quot;,{
  time: Date,
  hh(){
    const hr = this.time.getHours() % 12;
    return hr === 0 ? 12 : hr;
  },
  mm(){
    return this.time.getMinutes().toString().padStart(2,&quot;00&quot;);
  },
  ss(){
    return this.time.getSeconds().toString().padStart(2,&quot;00&quot;);
  }
});

can.Component.extend({
  tag: &quot;digital-clock&quot;,
  view: can.stache(`{{hh()}}:{{mm()}}:{{ss()}}`),
  ViewModel: DigitalClockVM
});

const ClockControlsVM = can.DefineMap.extend(&quot;ClockControlsVM&quot;,{
  time: {
    value({ resolve }) {
      const intervalID = setInterval(() =&gt; {
        resolve( new Date() );
      },1000);

      resolve( new Date() );

      return () =&gt; clearInterval(intervalID);
    }
  }
});

can.Component.extend({
  tag: &quot;clock-controls&quot;,
  ViewModel: ClockControlsVM,
  view: can.stache(`
    &lt;p&gt;{{time}}&lt;/p&gt;
    &lt;digital-clock time:from=&quot;time&quot;/&gt;
    &lt;analog-clock time:from=&quot;time&quot;/&gt;
  `)
});

</code></pre>
<p><span line-highlight='1-3,22-48,only'></span></p>
<h2>Clear the canvas and create a <code>drawNeedle</code> function</h2>
<h3>The problem</h3>
<p>In this section, we will:</p>
<ul>
<li>Clear the canvas before drawing the circle and needle.</li>
<li>Refactor the needle drawing code into a <code>drawNeedle(length, base60Distance, styles)</code> method where:
<ul>
<li><code>length</code> - is the length in pixels of the needle.</li>
<li><code>base60Distance</code> - is a number between 0-60 representing how far around the clock the
needle should be drawn.</li>
<li><code>styles</code> - An object of canvas context style properties and values like:
<pre><code class="language-js">{
  lineWidth: 2.0,
  strokeStyle: &quot;#FF0000&quot;,
  lineCap: &quot;round&quot;
}
</code></pre></li>
</ul></li>
</ul>
<h3>What you need to know</h3>
<ul>
<li>Move the <strong>draw circle</strong> into the <code>this.listenTo(&quot;time&quot;, ...)</code> event handler so it is redrawn
when the time changes.</li>
<li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/clearRect">clearRect(x, y, width, height)</a> to clear
the canvas.</li>
<li>Add a function inside the <code>connectedCallback</code> that will have access to all the variables created above it like:
<pre><code class="language-js">ViewModel: {
  connectedCallback() {
    const canvas = element.firstChild.getContext('2d');
    const diameter = 255;
    const radius = diameter/2 - 5;
    const center = diameter/2;

    const drawNeedle = (length, base60Distance, styles) =&gt; {
      canvas // -&gt; the canvas element
      ...
    };
  }
}
</code></pre></li>
</ul>
<h3>The solution</h3>
<p>Update the <strong>JavaScript</strong> tab to:</p>
<pre><code class="language-js">// 60 = 2π
const base60ToRadians = (base60Number) =&gt;
2 * Math.PI * base60Number / 60;

can.Component.extend({
  tag: &quot;analog-clock&quot;,
  view: can.stache(`&lt;canvas id=&quot;analog&quot;  width=&quot;255&quot; height=&quot;255&quot;&gt;&lt;/canvas&gt;`),
  ViewModel: {
    connectedCallback(element) {
      const canvas = element.firstChild.getContext('2d');
      const diameter = 255;
      const radius = diameter/2 - 5;
      const center = diameter/2;

      const drawNeedle = (length, base60Distance, styles) =&gt; {
        Object.assign(canvas, styles);
        const x = center + length * Math.sin(base60ToRadians(base60Distance)),
          y = center + length * -1 * Math.cos(base60ToRadians(base60Distance));
        canvas.beginPath();
        canvas.moveTo(center, center);
        canvas.lineTo(x, y);
        canvas.closePath();
        canvas.stroke();
      };

      this.listenTo(&quot;time&quot;, (ev, time) =&gt; {
        canvas.clearRect(0, 0, diameter, diameter);

        // draw circle
        canvas.lineWidth = 4.0;
        canvas.strokeStyle = &quot;#567&quot;;
        canvas.beginPath();
        canvas.arc(center, center, radius, 0, Math.PI * 2, true);
        canvas.closePath();
        canvas.stroke();

        // draw second hand
        const seconds = time.getSeconds() + this.time.getMilliseconds() / 1000;
        drawNeedle(
          radius * 0.85,
          seconds, {
            lineWidth: 2.0,
            strokeStyle: &quot;#FF0000&quot;,
            lineCap: &quot;round&quot;
          }
        );
    });
});

const DigitalClockVM = can.DefineMap.extend(&quot;DigitalClockVM&quot;,{
  time: Date,
  hh(){
    const hr = this.time.getHours() % 12;
    return hr === 0 ? 12 : hr;
  },
  mm(){
    return this.time.getMinutes().toString().padStart(2,&quot;00&quot;);
  },
  ss(){
    return this.time.getSeconds().toString().padStart(2,&quot;00&quot;);
  }
});

can.Component.extend({
  tag: &quot;digital-clock&quot;,
  view: can.stache(`{{hh()}}:{{mm()}}:{{ss()}}`),
  ViewModel: DigitalClockVM
});

const ClockControlsVM = can.DefineMap.extend(&quot;ClockControlsVM&quot;,{
  time: {
    value({ resolve }) {
      const intervalID = setInterval(() =&gt; {
        resolve( new Date() );
      },1000);

      resolve( new Date() );

      return () =&gt; clearInterval(intervalID);
    }
  }
});

can.Component.extend({
  tag: &quot;clock-controls&quot;,
  ViewModel: ClockControlsVM,
  view: can.stache(`
    &lt;p&gt;{{time}}&lt;/p&gt;
    &lt;digital-clock time:from=&quot;time&quot;/&gt;
    &lt;analog-clock time:from=&quot;time&quot;/&gt;
  `)
});

</code></pre>
<p><span line-highlight='15-24,27,29-35,37-46,only'></span></p>
<h2>Draw the minute and hour hand</h2>
<h3>The problem</h3>
<p>In this section, we will:</p>
<ul>
<li>Draw the minute hand <code>3</code> pixels wide, dark gray (<code>#423</code>), and 65% of the
clock's radius.</li>
<li>Draw the minute hand <code>4</code> pixels wide, dark blue (<code>#42F</code>), and 45% of the
clock's radius.</li>
</ul>
<h3>What you need to know</h3>
<p>You know everything at this point.  You got this!</p>
<h3>The solution</h3>
<p>Update the <strong>JavaScript</strong> tab to:</p>
<pre><code class="language-js">// 60 = 2π
const base60ToRadians = (base60Number) =&gt;
2 * Math.PI * base60Number / 60;

can.Component.extend({
  tag: &quot;analog-clock&quot;,
  view: can.stache(`&lt;canvas id=&quot;analog&quot;  width=&quot;255&quot; height=&quot;255&quot;&gt;&lt;/canvas&gt;`),
  ViewModel: {
    connectedCallback(element) {
      const canvas = element.firstChild.getContext('2d');
      const diameter = 255;
      const radius = diameter/2 - 5;
      const center = diameter/2;

      const drawNeedle = (length, base60Distance, styles) =&gt; {
        Object.assign(canvas, styles);
        const x = center + length * Math.sin(base60ToRadians(base60Distance)),
          y = center + length * -1 * Math.cos(base60ToRadians(base60Distance));
        canvas.beginPath();
        canvas.moveTo(center, center);
        canvas.lineTo(x, y);
        canvas.closePath();
        canvas.stroke();
      };

      // draw second hand
      this.listenTo(&quot;time&quot;, (ev, time) =&gt; {
        canvas.clearRect(0, 0, diameter, diameter);

        // draw circle
        canvas.lineWidth = 4.0;
        canvas.strokeStyle = &quot;#567&quot;;
        canvas.beginPath();
        canvas.arc(center, center, radius, 0, Math.PI * 2, true);
        canvas.closePath();
        canvas.stroke();

        // draw second hand
        const seconds = time.getSeconds() + this.time.getMilliseconds() / 1000;
        drawNeedle(
          radius * 0.85,
          seconds, {
            lineWidth: 2.0,
            strokeStyle: &quot;#FF0000&quot;,
            lineCap: &quot;round&quot;
          }
        );
        // draw minute hand
        const minutes = time.getMinutes() + seconds / 60;
        drawNeedle(
          radius * 0.65,
          minutes,
          {
            lineWidth:  3.0,
            strokeStyle: &quot;#423&quot;,
            lineCap: &quot;round&quot;
          }
        );
        // draw hour hand
        const hoursInBase60 = time.getHours() * 60 / 12 + minutes / 60;
        drawNeedle(
          radius * 0.45,
          hoursInBase60,
          {
            lineWidth:  4.0,
            strokeStyle: &quot;#42F&quot;,
            lineCap: &quot;round&quot;
          }
        );  
    });
});

const DigitalClockVM = can.DefineMap.extend(&quot;DigitalClockVM&quot;,{
  time: Date,
  hh(){
    const hr = this.time.getHours() % 12;
    return hr === 0 ? 12 : hr;
  },
  mm(){
    return this.time.getMinutes().toString().padStart(2,&quot;00&quot;);
  },
  ss(){
    return this.time.getSeconds().toString().padStart(2,&quot;00&quot;);
  }
});

can.Component.extend({
  tag: &quot;digital-clock&quot;,
  view: can.stache(`{{hh()}}:{{mm()}}:{{ss()}}`),
  ViewModel: DigitalClockVM
});

const ClockControlsVM = can.DefineMap.extend(&quot;ClockControlsVM&quot;,{
  time: {Default: Date, Type: Date},
  init(){
    setInterval(() =&gt; {
      this.time = new Date();
    },1000);
  }
});

can.Component.extend({
  tag: &quot;clock-controls&quot;,
  ViewModel: ClockControlsVM,
  view: can.stache(`
    &lt;p&gt;{{time}}&lt;/p&gt;
    &lt;digital-clock time:from=&quot;time&quot;/&gt;
    &lt;analog-clock time:from=&quot;time&quot;/&gt;
  `)
});

</code></pre>
<p><span line-highlight='48-69,only'></span></p>
<script src="//static.jsbin.com/js/embed.min.js?4.0.4"></script>

</section>

  


<script type="text/javascript">
  window.docObject = {"src":{"path":"docs/can-guides/commitment/recipes/canvas-clock/canvas-clock.md"},"description":"This guide walks you through building a canvas clock.   \n\n","name":"guides/recipes/canvas-clock","title":"Canvas Clock (Simple)","type":"page","parent":"guides/recipes","comment":" ","pathToRoot":"../../.."};
</script>
</article>
      
        <footer><p>CanJS is part of <a href="https://donejs.com" target="_blank">DoneJS</a>. Created and maintained by the core <a href="https://donejs.com/About.html#team" target="_blank">DoneJS team</a> and <a href="https://www.bitovi.com" target="_blank">Bitovi</a>. <strong>Currently 4.0.1.</strong></p>
</footer>
      
    </div>
  </div>
</div>
<survey-ad>
  <button aria-label="Close" class="close" type="button">
    <span aria-hidden="true">&times;</span>
  </button>
  <a href="https://donejs.com/survey.html" target="_blank">
    Help us improve CanJS by taking our community survey
  </a>
</survey-ad>


		
			<script>
				steal = {
				  	instantiated: {
				    	"bundles/bit-docs-site/static.css!$css" : null
				  	}
			  	};
			</script>
			<script type='text/javascript' data-main="bit-docs-site/static" src="../../static/steal.production.js"></script>
		
		<script async defer src="https://buttons.github.io/buttons.js"></script>

		<!-- root-level elements with attributes necessary for the app -->
		<div path-prefix="../.."></div>

	</body>
</html>
